{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, createTextVNode as _createTextVNode, withCtx as _withCtx, createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nvar _hoisted_1 = {\n  \"class\": \"campaign_analize\"\n};\nvar _hoisted_2 = {\n  \"class\": \"container mx-auto p-4\"\n};\nvar _hoisted_3 = /*#__PURE__*/_createElementVNode(\"h1\", {\n  \"class\": \"text-2xl font-bold mb-4 text-white\"\n}, \"Qeury -> BigQuery\", -1 /* HOISTED */);\nvar _hoisted_4 = {\n  \"class\": \"mb-4\"\n};\nvar _hoisted_5 = /*#__PURE__*/_createElementVNode(\"button\", {\n  \"class\": \"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded\"\n}, \" クエリ実行 \", -1 /* HOISTED */);\nvar _hoisted_6 = {\n  key: 0,\n  \"class\": \"mt-4 text-red-500\"\n};\nvar _hoisted_7 = {\n  key: 1,\n  \"class\": \"mt-4\"\n};\nvar _hoisted_8 = /*#__PURE__*/_createElementVNode(\"button\", {\n  \"class\": \"mt-2 bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded\"\n}, \" Download CSV \", -1 /* HOISTED */);\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_SideVar = _resolveComponent(\"SideVar\");\n  var _component_PageTitle = _resolveComponent(\"PageTitle\");\n  var _component_easy_data_table = _resolveComponent(\"easy-data-table\");\n  var _component_RightColumnOutline = _resolveComponent(\"RightColumnOutline\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createCommentVNode(\" side var  \"), _createVNode(_component_SideVar), _createCommentVNode(\" main div \"), _createVNode(_component_RightColumnOutline, null, {\n    \"default\": _withCtx(function () {\n      return [_createVNode(_component_PageTitle, null, {\n        \"default\": _withCtx(function () {\n          return [_createTextVNode(\"本番データ取得\")];\n        }),\n        _: 1 /* STABLE */\n      }), _createElementVNode(\"div\", _hoisted_2, [_hoisted_3, _createElementVNode(\"div\", _hoisted_4, [_withDirectives(_createElementVNode(\"textarea\", {\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = function ($event) {\n          return $data.sqlQuery = $event;\n        }),\n        \"class\": \"w-full p-2 border rounded\",\n        rows: \"5\",\n        placeholder: \"Enter your SQL query here\"\n      }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.sqlQuery]])]), _hoisted_5, $data.errorMessage ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, _toDisplayString($data.errorMessage), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true), $data.results.length ? (_openBlock(), _createElementBlock(\"div\", _hoisted_7, [_createVNode(_component_easy_data_table, {\n        data: $data.results,\n        columns: $data.columns\n      }, null, 8 /* PROPS */, [\"data\", \"columns\"]), _hoisted_8])) : _createCommentVNode(\"v-if\", true)])];\n    }),\n    _: 1 /* STABLE */\n  })]);\n}","map":{"version":3,"mappings":";;EACO,SAAM;AAAkB;;EAMpB,SAAM;AAAuB;8BAChCA,oBAAqE;EAAjE,SAAM;AAAoC,GAAC,mBAAiB;;EAC3D,SAAM;AAAM;8BAQjBA,oBAIS;EAHP,SAAM;AAAsE,GAC7E,SAED;;;EAEyB,SAAM;;;;EAIJ,SAAM;;8BAE/BA,oBAIS;EAHP,SAAM;AAA6E,GACpF,gBAED;;;;;;;uBAhCRC,oBAoCM,OApCNC,UAoCM,GAnCJC,kCAAkB,EAClBC,aAAWC,qBACXF,iCAAiB,EACjBC,aA+BqBE;wBA9BnB;MAAA,OAA8B,CAA9BF,aAA8BG;4BAAnB;UAAA,OAAO,kBAAP,SAAO;;;UAClBP,oBA4BM,OA5BNQ,UA4BM,GA3BJC,UAAqE,EACrET,oBAOM,OAPNU,UAOM,mBANJV,oBAKY;;iBAJDW,cAAQ;QAAA;QACjB,SAAM,2BAA2B;QACjCC,IAAI,EAAC,GAAG;QACRC,WAAW,EAAC;qDAHHF,cAAQ,OAMrBG,UAIS,EAEEH,kBAAY,kBAAvBV,oBAEM,OAFNc,UAEM,mBADDJ,kBAAY,uDAGNA,aAAO,CAACK,MAAM,kBAAzBf,oBAOM,OAPNgB,UAOM,GANJb,aAAsEc;QAApDC,IAAI,EAAER,aAAO;QAAGS,OAAO,EAAET;oDAC3CU,UAIS","names":["_createElementVNode","_createElementBlock","_hoisted_1","_createCommentVNode","_createVNode","_component_SideVar","_component_RightColumnOutline","_component_PageTitle","_hoisted_2","_hoisted_3","_hoisted_4","$data","rows","placeholder","_hoisted_5","_hoisted_6","length","_hoisted_7","_component_easy_data_table","data","columns","_hoisted_8"],"sourceRoot":"","sources":["/Users/kazuaki.aihara/Documents/GCP-access/src/views/Query.vue"],"sourcesContent":["<template>\n  <div class=\"campaign_analize\">\n    <!-- side var  -->\n    <SideVar />\n    <!-- main div -->\n    <RightColumnOutline>\n      <PageTitle>本番データ取得</PageTitle>\n      <div class=\"container mx-auto p-4\">\n        <h1 class=\"text-2xl font-bold mb-4 text-white\">Qeury -> BigQuery</h1>\n        <div class=\"mb-4\">\n          <textarea\n            v-model=\"sqlQuery\"\n            class=\"w-full p-2 border rounded\"\n            rows=\"5\"\n            placeholder=\"Enter your SQL query here\"\n          ></textarea>\n        </div>\n        <button\n          class=\"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded\"\n        >\n          クエリ実行\n        </button>\n\n        <div v-if=\"errorMessage\" class=\"mt-4 text-red-500\">\n          {{ errorMessage }}\n        </div>\n\n        <div v-if=\"results.length\" class=\"mt-4\">\n          <easy-data-table :data=\"results\" :columns=\"columns\"></easy-data-table>\n          <button\n            class=\"mt-2 bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded\"\n          >\n            Download CSV\n          </button>\n        </div>\n      </div>\n    </RightColumnOutline>\n  </div>\n</template>\n\n<script>\n// import api from \"../api/api.js\";\nimport axios from \"axios\";\n\nexport default {\n  name: \"tableView\",\n  components: {},\n  data() {\n    return {\n      sqlQuery: \"\",\n      errorMessage: \"\",\n      results: [],\n      columns: [],\n    };\n  },\n  mounted() {\n    this.getevents();\n    this.show_flag = true;\n  },\n  computed: {\n    authority: function () {\n      return this.$store.getters[\"authority\"];\n    },\n  },\n  methods: {\n    async executeQuery() {\n      try {\n        const response = await axios.post(\"/api/execute-sql\", {\n          sql: this.sqlQuery,\n        });\n        this.results = response.data.results;\n        if (this.results.length > 0) {\n          this.columns = Object.keys(this.results[0]).map((key) => ({\n            label: key,\n            field: key,\n          }));\n        } else {\n          this.columns = [];\n        }\n        this.errorMessage = \"\";\n      } catch (error) {\n        this.errorMessage = \"Error executing query: \" + error.message;\n        this.results = [];\n        this.columns = [];\n      }\n    },\n    downloadCSV() {\n      const headers = this.columns.map((col) => col.label).join(\",\");\n      const rows = this.results\n        .map((row) => this.columns.map((col) => row[col.field]).join(\",\"))\n        .join(\"\\n\");\n      const csvContent = `data:text/csv;charset=utf-8,${headers}\\n${rows}`;\n      const encodedUri = encodeURI(csvContent);\n      const link = document.createElement(\"a\");\n      link.setAttribute(\"href\", encodedUri);\n      link.setAttribute(\"download\", \"results.csv\");\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n    },\n  },\n};\n</script>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}