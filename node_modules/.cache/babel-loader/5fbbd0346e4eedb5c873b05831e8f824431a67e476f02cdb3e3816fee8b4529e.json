{"ast":null,"code":"import _regeneratorRuntime from \"/Users/kazuaki.aihara/Documents/fuelcrypto-organizer/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/kazuaki.aihara/Documents/fuelcrypto-organizer/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.replace.js\";\nimport SideVar from \"@/components/SideVar.vue\";\nimport api from \"../api/api\";\nexport default {\n  data: function data() {\n    return {\n      headerPic: null,\n      headerPreview: null,\n      headerPicUrl: null,\n      // S3 load用\n      winPic: null,\n      winPreview: null,\n      winText: null,\n      winPicUrl: null,\n      // S3 load用\n      losePic: null,\n      losePreview: null,\n      loseText: null,\n      losePicUrl: null // S3 load用\n    };\n  },\n\n  components: {\n    SideVar: SideVar\n  },\n  mounted: function mounted() {\n    this.getInstantwin();\n  },\n  computed: {\n    btnclass: function btnclass() {\n      var return_class = \"\";\n      var header = this.headerPic || this.headerPicUrl;\n      var win = this.winPic || this.winPicUrl;\n      var lose = this.losePic || this.losePicUrl;\n      if (header && win && this.winText && lose && this.loseText) {\n        return_class = \"text-blue-50 bg-blue-500 hover:bg-blue-600\";\n      } else {\n        return_class = \"text-gray-300 bg-gray-700 hover:bg-gray-800\";\n      }\n      return return_class;\n    }\n  },\n  methods: {\n    getInstantwin: function getInstantwin() {\n      var _this = this;\n      api.getInstantWin({\n        campaign_id: this.$route.params.id\n      }).then(function (response) {\n        // console.log(response);\n        _this.winText = response.data[0].win_text;\n        _this.loseText = response.data[0].lose_text;\n        _this.headerPicUrl = response.data[0].header_pic;\n        _this.winPicUrl = response.data[0].win_pic;\n        _this.losePicUrl = response.data[0].lose_pic;\n      })[\"catch\"](function (error) {});\n    },\n    selectedHeader: function selectedHeader(e) {\n      e.preventDefault();\n      var files = e.target.files;\n      this.headerPic = files[0];\n      this.createHeader(files[0]);\n    },\n    selectedWin: function selectedWin(e) {\n      e.preventDefault();\n      var files = e.target.files;\n      this.winPic = files[0];\n      this.createWin(files[0]);\n    },\n    selectedLose: function selectedLose(e) {\n      e.preventDefault();\n      var files = e.target.files;\n      this.losePic = files[0];\n      this.createLose(files[0]);\n    },\n    createHeader: function createHeader(file) {\n      var _this2 = this;\n      var reader = new FileReader();\n      reader.onload = function (e) {\n        _this2.headerPreview = e.target.result;\n      };\n      reader.readAsDataURL(file);\n    },\n    removeHeader: function removeHeader() {\n      this.headerPreview = false;\n    },\n    createWin: function createWin(file) {\n      var _this3 = this;\n      var reader = new FileReader();\n      reader.onload = function (e) {\n        _this3.winPreview = e.target.result;\n      };\n      reader.readAsDataURL(file);\n    },\n    removeWin: function removeWin() {\n      this.winPreview = false;\n    },\n    createLose: function createLose(file) {\n      var _this4 = this;\n      var reader = new FileReader();\n      reader.onload = function (e) {\n        _this4.losePreview = e.target.result;\n      };\n      reader.readAsDataURL(file);\n    },\n    removeLose: function removeLose() {\n      this.losePreview = false;\n    },\n    postPics: function () {\n      var _postPics = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var config, header, win, lose;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              config = {\n                headers: {\n                  \"content-type\": \"multipart/form-data\"\n                }\n              };\n              header = new FormData();\n              header.append(\"file\", this.headerPic);\n              win = new FormData();\n              win.append(\"file\", this.winPic);\n              lose = new FormData();\n              lose.append(\"file\", this.losePic);\n              // 順次アップロード判断＋アップロード\n              if (!this.headerPic) {\n                _context.next = 10;\n                break;\n              }\n              _context.next = 10;\n              return api.uploadHeader({\n                campaign_id: this.$route.params.id,\n                form: header\n              }, config).then(function (response) {\n                console.log(response);\n              })[\"catch\"](function (error) {\n                this.$toast.show(\"ヘッダー画像の登録に失敗しました\", {\n                  type: \"error\",\n                  position: \"top-right\",\n                  duration: 5000\n                });\n                console.log(error);\n              });\n            case 10:\n              if (!this.winPic) {\n                _context.next = 13;\n                break;\n              }\n              _context.next = 13;\n              return api.uploadWin({\n                campaign_id: this.$route.params.id,\n                form: win\n              }, config).then(function (response) {\n                console.log(response);\n              })[\"catch\"](function (error) {\n                this.$toast.show(\"当選画像の登録に失敗しました\", {\n                  type: \"error\",\n                  position: \"top-right\",\n                  duration: 5000\n                });\n                console.log(error);\n              });\n            case 13:\n              if (!this.losePic) {\n                _context.next = 16;\n                break;\n              }\n              _context.next = 16;\n              return api.uploadLose({\n                campaign_id: this.$route.params.id,\n                form: lose\n              }, config).then(function (response) {\n                console.log(response);\n              })[\"catch\"](function (error) {\n                this.$toast.show(\"落選画像の登録に失敗しました\", {\n                  type: \"error\",\n                  position: \"top-right\",\n                  duration: 5000\n                });\n                console.log(error);\n              });\n            case 16:\n              _context.next = 18;\n              return api.updateInstantWin({\n                campaign_id: this.$route.params.id,\n                win_text: this.winText,\n                lose_text: this.loseText\n              }, config).then(function (response) {\n                console.log(response);\n              })[\"catch\"](function (error) {\n                this.$toast.show(\"テキストの登録に失敗しました\", {\n                  type: \"error\",\n                  position: \"top-right\",\n                  duration: 5000\n                });\n                console.log(error);\n              });\n            case 18:\n              this.$router.replace(\"/campaigns\");\n            case 19:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this);\n      }));\n      function postPics() {\n        return _postPics.apply(this, arguments);\n      }\n      return postPics;\n    }()\n  }\n};","map":{"version":3,"mappings":"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","names":["SideVar","api","data","headerPic","headerPreview","headerPicUrl","winPic","winPreview","winText","winPicUrl","losePic","losePreview","loseText","losePicUrl","components","mounted","getInstantwin","computed","btnclass","return_class","header","win","lose","methods","getInstantWin","campaign_id","$route","params","id","then","response","win_text","lose_text","header_pic","win_pic","lose_pic","error","selectedHeader","e","preventDefault","files","target","createHeader","selectedWin","createWin","selectedLose","createLose","file","reader","FileReader","onload","result","readAsDataURL","removeHeader","removeWin","removeLose","postPics","config","headers","FormData","append","uploadHeader","form","console","log","$toast","show","type","position","duration","uploadWin","uploadLose","updateInstantWin","$router","replace"],"sourceRoot":"","sources":["/Users/kazuaki.aihara/Documents/fuelcrypto-organizer/src/views/CampaignPageCreate.vue"],"sourcesContent":["<template>\n  <!-- <input @change=\"selectedFile\" type=\"file\" name=\"file\" />\n  <button @click=\"upload\" type=\"submit\">アップロード</button> -->\n  <div class=\"campaignPageCreate\">\n    <div class=\"\">\n      <div>\n        <!-- side var  -->\n        <SideVar />\n        <!-- input panel -->\n        <div class=\"mx-auto lg:ml-80\">\n          <section class=\"py-2\">\n            <div class=\"container px-2 mx-auto\">\n              <div class=\"p-8 bg-gray-500 rounded-xl\">\n                <div\n                  class=\"flex flex-wrap items-center justify-between -mx-4 mb-8 pb-6 border-b border-gray-400 border-opacity-20\"\n                >\n                  <div class=\"w-full sm:w-auto px-4 mb-6 sm:mb-0\">\n                    <h4\n                      class=\"text-2xl font-bold tracking-wide text-white mb-1\"\n                    >\n                      キャンペーンページ登録\n                    </h4>\n                  </div>\n                  <div class=\"w-full sm:w-auto px-4\"></div>\n                </div>\n                <div\n                  class=\"flex flex-wrap items-center -mx-4 pb-8 mb-8 border-b border-gray-400 border-opacity-20\"\n                >\n                  <div class=\"w-full sm:w-1/3 px-4 mb-4 sm:mb-0\">\n                    <span class=\"text-sm font-medium text-gray-100\"\n                      >キャンペーン画像\n                    </span>\n                  </div>\n                  <input\n                    @change=\"selectedHeader\"\n                    type=\"file\"\n                    name=\"file\"\n                    class=\"text-gray-100\"\n                  />\n                  <div v-if=\"headerPreview\" class=\"pl-3 w-1/3\">\n                    <img :src=\"headerPreview\" alt=\"\" />\n                  </div>\n                  <div v-else class=\"pl-3 w-1/3\">\n                    <div v-if=\"headerPicUrl\">\n                      <img :src=\"headerPicUrl\" alt=\"header\" />\n                    </div>\n                  </div>\n                </div>\n                <div\n                  class=\"flex flex-wrap items-center -mx-4 pb-8 mb-8 border-b border-gray-400 border-opacity-20\"\n                >\n                  <div class=\"w-full sm:w-1/3 px-4 mb-4 sm:mb-0\">\n                    <span class=\"text-sm font-medium text-gray-100\"\n                      >当選画像\n                    </span>\n                  </div>\n                  <input\n                    @change=\"selectedWin\"\n                    type=\"file\"\n                    name=\"file\"\n                    class=\"text-gray-100\"\n                  />\n                  <div v-if=\"winPreview\" class=\"pl-3 w-1/3\">\n                    <img :src=\"winPreview\" alt=\"\" />\n                  </div>\n                  <div v-else class=\"pl-3 w-1/3\">\n                    <div v-if=\"winPicUrl\">\n                      <img :src=\"winPicUrl\" alt=\"win\" />\n                    </div>\n                  </div>\n                </div>\n                <div\n                  class=\"flex flex-wrap items-center -mx-4 pb-8 mb-8 border-b border-gray-400 border-opacity-20\"\n                >\n                  <div class=\"w-full sm:w-1/3 px-4 mb-4 sm:mb-0\">\n                    <span class=\"text-sm font-medium text-gray-100\"\n                      >当選時メッセージ</span\n                    >\n                  </div>\n                  <div class=\"w-full sm:w-2/3 px-4\">\n                    <div class=\"max-w-xl\">\n                      <textarea\n                        class=\"block py-4 px-3 w-full text-sm text-gray-50 placeholder-gray-300 font-medium outline-none bg-transparent border border-gray-400 hover:border-white focus:border-green-500 rounded-lg h-32\"\n                        maxlength=\"120\"\n                        v-model=\"winText\"\n                        placeholder=\"当たり！おめでとうございます！\"\n                      />\n                    </div>\n                  </div>\n                </div>\n\n                <div\n                  class=\"flex flex-wrap items-center -mx-4 pb-8 mb-8 border-b border-gray-400 border-opacity-20\"\n                >\n                  <div class=\"w-full sm:w-1/3 px-4 mb-4 sm:mb-0\">\n                    <span class=\"text-sm font-medium text-gray-100\"\n                      >落選画像\n                    </span>\n                  </div>\n                  <input\n                    @change=\"selectedLose\"\n                    type=\"file\"\n                    name=\"file\"\n                    class=\"text-gray-100\"\n                  />\n                  <div v-if=\"losePreview\" class=\"pl-3 w-1/3\">\n                    <img :src=\"losePreview\" alt=\"\" />\n                  </div>\n                  <div v-else class=\"pl-3 w-1/3\">\n                    <div v-if=\"losePicUrl\">\n                      <img :src=\"losePicUrl\" alt=\"win\" />\n                    </div>\n                  </div>\n                </div>\n                <div\n                  class=\"flex flex-wrap items-center -mx-4 pb-8 mb-8 border-b border-gray-400 border-opacity-20\"\n                >\n                  <div class=\"w-full sm:w-1/3 px-4 mb-4 sm:mb-0\">\n                    <span class=\"text-sm font-medium text-gray-100\"\n                      >落選時メッセージ</span\n                    >\n                  </div>\n                  <div class=\"w-full sm:w-2/3 px-4\">\n                    <div class=\"max-w-xl\">\n                      <textarea\n                        class=\"block py-4 px-3 w-full text-sm text-gray-50 placeholder-gray-300 font-medium outline-none bg-transparent border border-gray-400 hover:border-white focus:border-green-500 rounded-lg h-32\"\n                        v-model=\"loseText\"\n                        maxlength=\"120\"\n                        placeholder=\"残念！今後も楽しいキャンペーンを開催しますので是非ご参加ください\"\n                      />\n                    </div>\n                  </div>\n                </div>\n                <button\n                  class=\"inline-block py-2 px-4 text-xs text-center font-semibold leading-normal rounded-lg transition duration-200\"\n                  v-bind:class=\"btnclass\"\n                  @click=\"postPics\"\n                >\n                  登録\n                </button>\n              </div>\n            </div>\n          </section>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport SideVar from \"@/components/SideVar.vue\";\nimport api from \"../api/api\";\nexport default {\n  data: function () {\n    return {\n      headerPic: null,\n      headerPreview: null,\n      headerPicUrl: null, // S3 load用\n      winPic: null,\n      winPreview: null,\n      winText: null,\n      winPicUrl: null, // S3 load用\n      losePic: null,\n      losePreview: null,\n      loseText: null,\n      losePicUrl: null, // S3 load用\n    };\n  },\n  components: {\n    SideVar,\n  },\n  mounted() {\n    this.getInstantwin();\n  },\n  computed: {\n    btnclass() {\n      let return_class = \"\";\n      let header = this.headerPic || this.headerPicUrl;\n      let win = this.winPic || this.winPicUrl;\n      let lose = this.losePic || this.losePicUrl;\n      if (header && win && this.winText && lose && this.loseText) {\n        return_class = \"text-blue-50 bg-blue-500 hover:bg-blue-600\";\n      } else {\n        return_class = \"text-gray-300 bg-gray-700 hover:bg-gray-800\";\n      }\n      return return_class;\n    },\n  },\n  methods: {\n    getInstantwin: function () {\n      api\n        .getInstantWin({ campaign_id: this.$route.params.id })\n        .then((response) => {\n          // console.log(response);\n          this.winText = response.data[0].win_text;\n          this.loseText = response.data[0].lose_text;\n          this.headerPicUrl = response.data[0].header_pic;\n          this.winPicUrl = response.data[0].win_pic;\n          this.losePicUrl = response.data[0].lose_pic;\n        })\n        .catch((error) => {});\n    },\n    selectedHeader: function (e) {\n      e.preventDefault();\n      let files = e.target.files;\n      this.headerPic = files[0];\n      this.createHeader(files[0]);\n    },\n    selectedWin: function (e) {\n      e.preventDefault();\n      let files = e.target.files;\n      this.winPic = files[0];\n      this.createWin(files[0]);\n    },\n    selectedLose: function (e) {\n      e.preventDefault();\n      let files = e.target.files;\n      this.losePic = files[0];\n      this.createLose(files[0]);\n    },\n    createHeader(file) {\n      const reader = new FileReader();\n      reader.onload = (e) => {\n        this.headerPreview = e.target.result;\n      };\n      reader.readAsDataURL(file);\n    },\n    removeHeader() {\n      this.headerPreview = false;\n    },\n    createWin(file) {\n      const reader = new FileReader();\n      reader.onload = (e) => {\n        this.winPreview = e.target.result;\n      };\n      reader.readAsDataURL(file);\n    },\n    removeWin() {\n      this.winPreview = false;\n    },\n    createLose(file) {\n      const reader = new FileReader();\n      reader.onload = (e) => {\n        this.losePreview = e.target.result;\n      };\n      reader.readAsDataURL(file);\n    },\n    removeLose() {\n      this.losePreview = false;\n    },\n    postPics: async function () {\n      let config = {\n        headers: {\n          \"content-type\": \"multipart/form-data\",\n        },\n      };\n      let header = new FormData();\n      header.append(\"file\", this.headerPic);\n      let win = new FormData();\n      win.append(\"file\", this.winPic);\n      let lose = new FormData();\n      lose.append(\"file\", this.losePic);\n      // 順次アップロード判断＋アップロード\n      if (this.headerPic) {\n        await api\n          .uploadHeader(\n            { campaign_id: this.$route.params.id, form: header },\n            config\n          )\n          .then(function (response) {\n            console.log(response);\n          })\n          .catch(function (error) {\n            this.$toast.show(\"ヘッダー画像の登録に失敗しました\", {\n              type: \"error\",\n              position: \"top-right\",\n              duration: 5000,\n            });\n            console.log(error);\n          });\n      }\n      if (this.winPic) {\n        await api\n          .uploadWin({ campaign_id: this.$route.params.id, form: win }, config)\n          .then(function (response) {\n            console.log(response);\n          })\n          .catch(function (error) {\n            this.$toast.show(\"当選画像の登録に失敗しました\", {\n              type: \"error\",\n              position: \"top-right\",\n              duration: 5000,\n            });\n            console.log(error);\n          });\n      }\n      if (this.losePic) {\n        await api\n          .uploadLose(\n            { campaign_id: this.$route.params.id, form: lose },\n            config\n          )\n          .then(function (response) {\n            console.log(response);\n          })\n          .catch(function (error) {\n            this.$toast.show(\"落選画像の登録に失敗しました\", {\n              type: \"error\",\n              position: \"top-right\",\n              duration: 5000,\n            });\n            console.log(error);\n          });\n      }\n      await api\n        .updateInstantWin(\n          {\n            campaign_id: this.$route.params.id,\n            win_text: this.winText,\n            lose_text: this.loseText,\n          },\n          config\n        )\n        .then(function (response) {\n          console.log(response);\n        })\n        .catch(function (error) {\n          this.$toast.show(\"テキストの登録に失敗しました\", {\n            type: \"error\",\n            position: \"top-right\",\n            duration: 5000,\n          });\n          console.log(error);\n        });\n      this.$router.replace(\"/campaigns\");\n    },\n  },\n};\n</script>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}