{"ast":null,"code":"import _regeneratorRuntime from \"/Users/kazuaki.aihara/Documents/hanabi-admin/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/kazuaki.aihara/Documents/hanabi-admin/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.replace.js\";\nimport api from \"@/api/api.js\";\nimport store from \"@/store\";\nimport { createHash } from \"crypto\";\nexport default {\n  data: function data() {\n    return {\n      username: \"\",\n      password: \"\",\n      loading: false\n    };\n  },\n  computed: {\n    user_id: function user_id() {\n      return this.$store.getters[\"userId\"];\n    },\n    token: function token() {\n      return this.$store.getters[\"authToken\"];\n    }\n  },\n  methods: {\n    signIn: function () {\n      var _signIn = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var _this = this;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return api.login({\n                name: this.username,\n                password: this.password\n              }).then(function (response) {\n                console.log(respose);\n                var hash = createHash(\"sha256\");\n                hash.update(password);\n                hash.update(response);\n                var token = hash.digest(\"hex\");\n                if (user.emailVerified == false) {\n                  _this.$toast.show(\"メール認証が未済です。送付したメールから認証を完了してください\", {\n                    type: \"warning\",\n                    position: \"top-right\",\n                    duration: 5000\n                  });\n                  sendEmailVerification(user, {\n                    url: \"https://social-marketing.io/login\"\n                  });\n                  _this.loading = false;\n                } else {\n                  store.commit(\"updateUser\", user);\n                  _this.$toast.show(\"ログインしました\", {\n                    type: \"success\",\n                    position: \"top-right\",\n                    duration: 3000\n                  });\n                  api.getAccounts().then(function () {\n                    api.checkSubscribe().then(function (response) {\n                      store.commit(\"updateSubscribePlan\", response[\"data\"]);\n                      _this.$router.replace(\"/campaigns\");\n                    })[\"catch\"](function (error) {\n                      _this.$toast.show(\"プラン取得に失敗しました\", {\n                        type: \"error\",\n                        position: \"top-right\",\n                        duration: 5000\n                      });\n                      console.log(\"subscribe error:\", error);\n                      _this.$router.replace(\"/campaigns\");\n                    });\n                    _this.loading = false;\n                    _this.$router.replace(\"/campaigns\");\n                  })[\"catch\"](function (error) {\n                    _this.$toast.show(\"アカウントの取得に失敗しました\", {\n                      type: \"error\",\n                      position: \"top-right\",\n                      duration: 5000\n                    });\n                    console.log(\"login getAccounts error:\", error);\n                    _this.loading = false;\n                  });\n                }\n              })[\"catch\"](function (error) {\n                _this.$toast.show(\"EmailかPasswordが間違っています\", {\n                  type: \"error\",\n                  position: \"top-right\",\n                  duration: 5000\n                });\n                _this.loading = false;\n                console.log(error.code + \" \" + error.message);\n              });\n            case 2:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this);\n      }));\n      function signIn() {\n        return _signIn.apply(this, arguments);\n      }\n      return signIn;\n    }(),\n    refresh_error: function refresh_error() {\n      this.error_message = \"\";\n    }\n  }\n};","map":{"version":3,"mappings":";;;;AAoEA,OAAOA,GAAE,MAAO,cAAc;AAC9B,OAAOC,KAAI,MAAO,SAAS;AAC3B,SAASC,UAAS,QAAS,QAAQ;AAEnC,eAAe;EACbC,IAAI,kBAAG;IACL,OAAO;MACLC,QAAQ,EAAE,EAAE;MACZC,QAAQ,EAAE,EAAE;MACZC,OAAO,EAAE;IACX,CAAC;EACH,CAAC;EACDC,QAAQ,EAAE;IACRC,OAAO,qBAAG;MACR,OAAO,IAAI,CAACC,MAAM,CAACC,OAAO,CAAC,QAAQ,CAAC;IACtC,CAAC;IACDC,KAAK,mBAAG;MACN,OAAO,IAAI,CAACF,MAAM,CAACC,OAAO,CAAC,WAAW,CAAC;IACzC;EACF,CAAC;EACDE,OAAO,EAAE;IACPC,MAAM;MAAA,yEAAE;QAAA;QAAA;UAAA;YAAA;cAAA;cAAA,OACAb,GAAE,CACLc,KAAK,CAAC;gBACLC,IAAI,EAAE,IAAI,CAACX,QAAQ;gBACnBC,QAAQ,EAAE,IAAI,CAACA;cACjB,CAAC,EACAW,IAAI,CAAC,UAACC,QAAQ,EAAK;gBAClBC,OAAO,CAACC,GAAG,CAACC,OAAO,CAAC;gBACpB,IAAMC,IAAG,GAAInB,UAAU,CAAC,QAAQ,CAAC;gBACjCmB,IAAI,CAACC,MAAM,CAACjB,QAAQ,CAAC;gBACrBgB,IAAI,CAACC,MAAM,CAACL,QAAQ,CAAC;gBACrB,IAAMN,KAAI,GAAIU,IAAI,CAACE,MAAM,CAAC,KAAK,CAAC;gBAEhC,IAAIC,IAAI,CAACC,aAAY,IAAK,KAAK,EAAE;kBAC/B,KAAI,CAACC,MAAM,CAACC,IAAI,CACd,iCAAiC,EACjC;oBACEC,IAAI,EAAE,SAAS;oBACfC,QAAQ,EAAE,WAAW;oBACrBC,QAAQ,EAAE;kBACZ,EACD;kBACDC,qBAAqB,CAACP,IAAI,EAAE;oBAC1BQ,GAAG,EAAE;kBACP,CAAC,CAAC;kBACF,KAAI,CAAC1B,OAAM,GAAI,KAAK;gBACtB,OAAO;kBACLL,KAAK,CAACgC,MAAM,CAAC,YAAY,EAAET,IAAI,CAAC;kBAChC,KAAI,CAACE,MAAM,CAACC,IAAI,CAAC,UAAU,EAAE;oBAC3BC,IAAI,EAAE,SAAS;oBACfC,QAAQ,EAAE,WAAW;oBACrBC,QAAQ,EAAE;kBACZ,CAAC,CAAC;kBACF9B,GAAE,CACCkC,WAAW,EAAC,CACZlB,IAAI,CAAC,YAAM;oBACVhB,GAAE,CACCmC,cAAc,EAAC,CACfnB,IAAI,CAAC,UAACC,QAAQ,EAAK;sBAClBhB,KAAK,CAACgC,MAAM,CAAC,qBAAqB,EAAEhB,QAAQ,CAAC,MAAM,CAAC,CAAC;sBACrD,KAAI,CAACmB,OAAO,CAACC,OAAO,CAAC,YAAY,CAAC;oBACpC,CAAC,UACK,CAAC,UAACC,KAAK,EAAK;sBAChB,KAAI,CAACZ,MAAM,CAACC,IAAI,CAAC,cAAc,EAAE;wBAC/BC,IAAI,EAAE,OAAO;wBACbC,QAAQ,EAAE,WAAW;wBACrBC,QAAQ,EAAE;sBACZ,CAAC,CAAC;sBACFZ,OAAO,CAACC,GAAG,CAAC,kBAAkB,EAAEmB,KAAK,CAAC;sBACtC,KAAI,CAACF,OAAO,CAACC,OAAO,CAAC,YAAY,CAAC;oBACpC,CAAC,CAAC;oBACJ,KAAI,CAAC/B,OAAM,GAAI,KAAK;oBACpB,KAAI,CAAC8B,OAAO,CAACC,OAAO,CAAC,YAAY,CAAC;kBACpC,CAAC,UACK,CAAC,UAACC,KAAK,EAAK;oBAChB,KAAI,CAACZ,MAAM,CAACC,IAAI,CAAC,iBAAiB,EAAE;sBAClCC,IAAI,EAAE,OAAO;sBACbC,QAAQ,EAAE,WAAW;sBACrBC,QAAQ,EAAE;oBACZ,CAAC,CAAC;oBACFZ,OAAO,CAACC,GAAG,CAAC,0BAA0B,EAAEmB,KAAK,CAAC;oBAC9C,KAAI,CAAChC,OAAM,GAAI,KAAK;kBACtB,CAAC,CAAC;gBACN;cACF,CAAC,UACK,CAAC,UAACgC,KAAK,EAAK;gBAChB,KAAI,CAACZ,MAAM,CAACC,IAAI,CAAC,wBAAwB,EAAE;kBACzCC,IAAI,EAAE,OAAO;kBACbC,QAAQ,EAAE,WAAW;kBACrBC,QAAQ,EAAE;gBACZ,CAAC,CAAC;gBACF,KAAI,CAACxB,OAAM,GAAI,KAAK;gBACpBY,OAAO,CAACC,GAAG,CAACmB,KAAK,CAACC,IAAG,GAAI,GAAE,GAAID,KAAK,CAACE,OAAO,CAAC;cAC/C,CAAC,CAAC;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA,CACL;MAAA;QAAA;MAAA;MAAA;IAAA;IACDC,aAAa,EAAE,yBAAY;MACzB,IAAI,CAACC,aAAY,GAAI,EAAE;IACzB;EACF;AACF,CAAC","names":["api","store","createHash","data","username","password","loading","computed","user_id","$store","getters","token","methods","signIn","login","name","then","response","console","log","respose","hash","update","digest","user","emailVerified","$toast","show","type","position","duration","sendEmailVerification","url","commit","getAccounts","checkSubscribe","$router","replace","error","code","message","refresh_error","error_message"],"sourceRoot":"","sources":["/Users/kazuaki.aihara/Documents/hanabi-admin/src/views/LoginPage.vue"],"sourcesContent":["<template>\n  <div class=\"login_page\">\n    <section class=\"relative pt-24\">\n      <div class=\"container px-4 mx-auto\">\n        <div class=\"h-full\">\n          <div class=\"relative max-w-xs mx-auto text-center\">\n            <a\n              class=\"w-24 inline-block mx-auto mb-10\"\n              href=\"https://social-marketing.io\"\n            >\n              <img class=\"block\" src=\"../assets/icon.jpg\" />\n            </a>\n            <h2 class=\"text-2xl text-gray-500 font-semibold mb-2\"></h2>\n            <p class=\"text-gray-400 font-medium mb-10\">\n              Welcome back! Please enter your account.\n            </p>\n            <form action=\"\">\n              <div\n                class=\"relative w-full h-14 py-4 px-3 mb-8 border border-gray-400 hover:border-blue focus-within:border-green-500 rounded-lg\"\n              >\n                <span\n                  class=\"absolute bottom-full left-0 ml-3 -mb-1 transform translate-y-0.5 text-xs font-semibold text-gray-600 px-1 bg-gray-200\"\n                  >username</span\n                >\n                <input\n                  class=\"block w-full outline-none text-sm text-gray-600 font-medium\"\n                  type=\"text\"\n                  placeholder=\"hanabi\"\n                  v-model=\"username\"\n                />\n              </div>\n              <div\n                class=\"relative w-full h-14 py-4 px-3 mb-3 border border-gray-400 hover:border-blue focus-within:border-green-500 rounded-lg\"\n              >\n                <span\n                  class=\"absolute bottom-full left-0 ml-3 -mb-1 transform translate-y-0.5 text-xs font-semibold text-gray-600 px-1 bg-gray-200\"\n                  >Password</span\n                >\n                <input\n                  class=\"block w-full outline-none bg-transparent text-sm text-gray-600 font-medium\"\n                  id=\"password\"\n                  type=\"password\"\n                  placeholder=\"password\"\n                  v-model=\"password\"\n                />\n              </div>\n            </form>\n            <button\n              class=\"mt-6 block w-full py-4 mb-4 leading-6 text-white font-semibold rounded-lg transition duration-200\"\n              :class=\"\n                username != '' && this.password != '' && !loading\n                  ? 'bg-blue-500 hover:bg-blue-600'\n                  : 'bg-gray-500 hover:bg-gray-600'\n              \"\n              :disabled=\"!username || !password || loading\"\n              @click=\"signIn\"\n            >\n              <i class=\"pi pi-spin pi-spinner text-sm\" v-if=\"loading\"></i>\n              Sign In\n            </button>\n          </div>\n        </div>\n      </div>\n    </section>\n  </div>\n</template>\n\n<script>\nimport api from \"@/api/api.js\";\nimport store from \"@/store\";\nimport { createHash } from \"crypto\";\n\nexport default {\n  data() {\n    return {\n      username: \"\",\n      password: \"\",\n      loading: false,\n    };\n  },\n  computed: {\n    user_id() {\n      return this.$store.getters[\"userId\"];\n    },\n    token() {\n      return this.$store.getters[\"authToken\"];\n    },\n  },\n  methods: {\n    signIn: async function () {\n      await api\n        .login({\n          name: this.username,\n          password: this.password,\n        })\n        .then((response) => {\n          console.log(respose);\n          const hash = createHash(\"sha256\");\n          hash.update(password);\n          hash.update(response);\n          const token = hash.digest(\"hex\");\n\n          if (user.emailVerified == false) {\n            this.$toast.show(\n              \"メール認証が未済です。送付したメールから認証を完了してください\",\n              {\n                type: \"warning\",\n                position: \"top-right\",\n                duration: 5000,\n              }\n            );\n            sendEmailVerification(user, {\n              url: \"https://social-marketing.io/login\",\n            });\n            this.loading = false;\n          } else {\n            store.commit(\"updateUser\", user);\n            this.$toast.show(\"ログインしました\", {\n              type: \"success\",\n              position: \"top-right\",\n              duration: 3000,\n            });\n            api\n              .getAccounts()\n              .then(() => {\n                api\n                  .checkSubscribe()\n                  .then((response) => {\n                    store.commit(\"updateSubscribePlan\", response[\"data\"]);\n                    this.$router.replace(\"/campaigns\");\n                  })\n                  .catch((error) => {\n                    this.$toast.show(\"プラン取得に失敗しました\", {\n                      type: \"error\",\n                      position: \"top-right\",\n                      duration: 5000,\n                    });\n                    console.log(\"subscribe error:\", error);\n                    this.$router.replace(\"/campaigns\");\n                  });\n                this.loading = false;\n                this.$router.replace(\"/campaigns\");\n              })\n              .catch((error) => {\n                this.$toast.show(\"アカウントの取得に失敗しました\", {\n                  type: \"error\",\n                  position: \"top-right\",\n                  duration: 5000,\n                });\n                console.log(\"login getAccounts error:\", error);\n                this.loading = false;\n              });\n          }\n        })\n        .catch((error) => {\n          this.$toast.show(\"EmailかPasswordが間違っています\", {\n            type: \"error\",\n            position: \"top-right\",\n            duration: 5000,\n          });\n          this.loading = false;\n          console.log(error.code + \" \" + error.message);\n        });\n    },\n    refresh_error: function () {\n      this.error_message = \"\";\n    },\n  },\n};\n</script>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}