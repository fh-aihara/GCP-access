{"ast":null,"code":"import \"core-js/modules/es.date.to-string.js\";\nimport \"core-js/modules/es.array.index-of.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.replace.js\";\nimport SideVar from \"@/components/SideVar.vue\";\nimport Datepicker from \"@vuepic/vue-datepicker\";\nimport \"@vuepic/vue-datepicker/dist/main.css\";\nimport api from \"../api/api.js\";\nimport { ref } from \"vue\";\nimport { useRoute } from \"vue-router\";\nimport checks from \"../assets/mixins/Checks\";\nexport default {\n  name: \"Campaign_modify\",\n  mixins: [checks],\n  components: {\n    SideVar: SideVar,\n    Datepicker: Datepicker\n  },\n  setup: function setup() {\n    var date = ref();\n    return {\n      date: date\n    };\n  },\n  data: function data() {\n    return {\n      campaign_name: null,\n      category: null,\n      keyword: null,\n      \"abstract\": null,\n      detail: null,\n      reword_amount: null,\n      reword_currency: null,\n      distribution_type: null,\n      today: new Date(),\n      start_date_db: new Date(),\n      nouse_in_this_version: false,\n      conditions_twitter_account: [],\n      conditions_tweet: [],\n      estimated_participants_count: null\n    };\n  },\n  mounted: function mounted() {\n    var _this = this;\n    var route = useRoute();\n    api.getCampaign({\n      id: route.params.id\n    }).then(function (response) {\n      _this.campaign_name = response.data[0][\"campaign_name\"];\n      _this.category = response.data[0][\"category\"];\n      _this.keyword = response.data[0][\"keyword\"];\n      _this[\"abstract\"] = response.data[0][\"abstruct\"];\n      _this.detail = response.data[0][\"detail\"];\n      _this.reword_amount = response.data[0][\"amount\"];\n      _this.reword_currency = response.data[0][\"currency_id\"];\n      _this.distribution_type = response.data[0][\"distribution_type\"];\n      // JSTに変換\n      var start_date = new Date(response.data[0][\"start_time\"]);\n      start_date.setHours(start_date.getHours() + 9);\n      var end_date = new Date(response.data[0][\"end_time\"]);\n      end_date.setHours(end_date.getHours() + 9);\n      _this.date = [start_date, end_date];\n      _this.start_date_db = response.data[0][\"start_time\"];\n      if (_this.category == \"HASHTAG\") {\n        _this.keyword_check = true;\n      }\n      if (_this.category == \"INSTANT_WIN\") {\n        api.getInstantWin({\n          campaign_id: route.params.id\n        }).then(function (response) {\n          console.log(response);\n          _this.estimated_participants_count = response.data[0].est_participant;\n        });\n      }\n    })[\"catch\"](function (error) {\n      _this.$toast.show(\"キャンペーンの取得に失敗しました\", {\n        type: \"error\",\n        position: \"top-right\",\n        duration: 5000\n      });\n      console.log(\"error: \", error);\n    });\n  },\n  computed: {\n    plan: function plan() {\n      return this.$store.getters[\"subscribePlan\"];\n    },\n    min_date: function min_date() {\n      var default_min = new Date(new Date().setHours(this.today.getHours() + 1));\n      if (default_min >= this.start_date_db) {\n        return this.start_date_db;\n      } else {\n        return default_min;\n      }\n    },\n    filled: function filled() {\n      return this.campaign_name && this.keyword_check && this.category && this.keyword;\n    },\n    follow_and_retweet_filled: function follow_and_retweet_filled() {\n      return this.campaign_name && this.category && this.reword_amount && this.date[1]\n      // conditionsの変更はmodifyからは行わない\n      ;\n    },\n    instant_win_filled: function instant_win_filled() {\n      return this.campaign_name && this.category && this.reword_amount && this.date[1] &&\n      // conditionsの変更はmodifyからは行わない\n      this.estimated_participants_count;\n    },\n    condition_flag: function condition_flag() {\n      var return_dict = {\n        keyword: false,\n        abstruct: false,\n        detail: false,\n        distribution_type: false,\n        amount: false,\n        currency_id: false,\n        start_time: false,\n        end_time: false,\n        twitter_account: false,\n        twitter_url: false\n      };\n      if (this.category == null) {\n        return return_dict;\n      } else if (this.category == \"HASHTAG\") {\n        // init\n        return_dict = {\n          keyword: true,\n          abstruct: true,\n          detail: true,\n          distribution_type: false,\n          amount: false,\n          currency_id: false,\n          start_time: true,\n          end_time: true,\n          twitter_account: false,\n          twitter_url: false\n        };\n        return return_dict;\n      } else if (this.category == \"FOLLOW_AND_RETWEET\") {\n        // init\n        return_dict = {\n          keyword: false,\n          abstruct: false,\n          detail: false,\n          distribution_type: false,\n          amount: true,\n          currency_id: false,\n          start_time: false,\n          end_time: true,\n          twitter_account: false,\n          twitter_url: false\n        };\n        return return_dict;\n      } else if (this.category == \"INSTANT_WIN\") {\n        return_dict = {\n          keyword: false,\n          abstruct: false,\n          detail: false,\n          distribution_type: false,\n          amount: true,\n          estimated_participants_count: true,\n          currency_id: false,\n          start_time: true,\n          end_time: true,\n          twitter_account: false,\n          twitter_url: false\n        };\n        return return_dict;\n      } else {\n        return return_dict;\n      }\n    }\n  },\n  watch: {\n    keyword: function keyword(value) {\n      this.keyword_check = false;\n      this.keyword_check_result = \"\";\n      if (value.indexOf(\"#\")) {\n        this.keyword = \"#\" + value;\n      }\n    },\n    twitter_account: function twitter_account(value) {\n      this.twitter_account_check = false;\n      this.twitter_account_result = \"\";\n      if (value.indexOf(\"@\")) {\n        this.twitter_account = \"@\" + value;\n      }\n    },\n    tweet_url: function tweet_url() {\n      this.tweet_url_check = false;\n      this.tweet_url_result = \"\";\n    }\n  },\n  methods: {\n    patchCampaignPromise: function patchCampaignPromise() {\n      var _this2 = this;\n      return new Promise(function (resolve) {\n        api.updateCampaign({\n          id: _this2.$route.params.id,\n          keyword: _this2.keyword,\n          start_time: _this2.date[0],\n          end_time: _this2.date[1],\n          campaign_name: _this2.campaign_name,\n          distribution_type: _this2.distribution_type,\n          amount: _this2.reword_amount,\n          currency_id: _this2.reword_currency,\n          category: _this2.category\n        }).then(function () {\n          if (_this2.category == \"INSTANT_WIN\") {\n            api.updateInstantWin({\n              campaign_id: _this2.$route.params.id,\n              total_win: _this2.reword_amount,\n              est_participant: _this2.estimated_participants_count,\n              remain_win: _this2.reword_amount,\n              prob: _this2.reword_amount / _this2.estimated_participants_count\n            }).then(function () {\n              _this2.$toast.show(\"キャンペーンの変更が完了しました\", {\n                type: \"success\",\n                position: \"top-right\",\n                duration: 3000\n              });\n              _this2.$router.replace(\"/campaigns\");\n            })[\"catch\"](function (error) {\n              _this2.$toast.show(\"インスタントウィンの変更に失敗しました\", {\n                type: \"error\",\n                position: \"top-right\",\n                duration: 5000\n              });\n              console.log(\"error: \", error);\n            });\n          } else {\n            _this2.$toast.show(\"キャンペーンの変更が完了しました\", {\n              type: \"success\",\n              position: \"top-right\",\n              duration: 3000\n            });\n            _this2.$router.replace(\"/campaigns\");\n          }\n          resolve(\"resolved\");\n        })[\"catch\"](function (error) {\n          _this2.$toast.show(\"キャンペーンの変更に失敗しました\", {\n            type: \"error\",\n            position: \"top-right\",\n            duration: 5000\n          });\n          console.log(\"error: \", error);\n          resolve(\"rejected\");\n        });\n      });\n    }\n  }\n};","map":{"version":3,"mappings":"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","names":["SideVar","Datepicker","api","ref","useRoute","checks","name","mixins","components","setup","date","data","campaign_name","category","keyword","detail","reword_amount","reword_currency","distribution_type","today","Date","start_date_db","nouse_in_this_version","conditions_twitter_account","conditions_tweet","estimated_participants_count","mounted","route","getCampaign","id","params","then","response","start_date","setHours","getHours","end_date","keyword_check","getInstantWin","campaign_id","console","log","est_participant","error","$toast","show","type","position","duration","computed","plan","$store","getters","min_date","default_min","filled","follow_and_retweet_filled","instant_win_filled","condition_flag","return_dict","abstruct","amount","currency_id","start_time","end_time","twitter_account","twitter_url","watch","value","keyword_check_result","indexOf","twitter_account_check","twitter_account_result","tweet_url","tweet_url_check","tweet_url_result","methods","patchCampaignPromise","Promise","resolve","updateCampaign","$route","updateInstantWin","total_win","remain_win","prob","$router","replace"],"sourceRoot":"","sources":["/Users/kazuaki.aihara/Documents/fuelcrypto-organizer/src/views/CampaignModify.vue"],"sourcesContent":["<template>\n  <div class=\"campaign_modify\">\n    <div class=\"\">\n      <div>\n        <SideVar />\n        <RightColumnOutline>\n          <PageTitle>Modify Campaign</PageTitle>\n          <div\n            class=\"flex flex-wrap items-center pb-8 mb-8 border-b border-gray-400 border-opacity-20\"\n          >\n            <div class=\"w-1/3 pl-18 text-left\">\n              <span class=\"text-sm font-medium text-gray-100\"\n                >キャンペーン名 *\n              </span>\n            </div>\n            <div class=\"w-2/3 px-4 max-w-xl\">\n              <div class=\"flex flex-wrap items-center -mx-3 w-full px-3\">\n                <input\n                  class=\"block py-4 px-3 w-full text-sm text-gray-50 placeholder-gray-300 font-medium outline-none bg-transparent border border-gray-400 hover:border-white focus:border-green-500 rounded-lg\"\n                  type=\"text\"\n                  v-model=\"campaign_name\"\n                  placeholder=\"xxxx記念キャンペーン\"\n                />\n              </div>\n            </div>\n          </div>\n          <div\n            class=\"flex flex-wrap items-center pb-8 mb-8 border-b border-gray-400 border-opacity-20\"\n          >\n            <div class=\"w-1/3 pl-18 text-left\">\n              <span class=\"text-sm font-medium text-gray-100\"\n                >開催するキャンペーンの種類 *\n              </span>\n            </div>\n            <div class=\"w-2/3 px-4 max-w-xl\">\n              <div\n                class=\"relative block px-3 w-full text-sm font-medium border border-gray-400 hover:border-white focus-within:border-green-500 rounded-lg\"\n              >\n                <span\n                  class=\"absolute top-1/2 right-0 mr-5 transform -translate-y-1/2\"\n                >\n                  <i class=\"pi pi-chevron-down\"></i>\n                </span>\n                <select\n                  class=\"w-full py-4 text-gray-50 placeholder-gray-300 appearance-none bg-transparent outline-none\"\n                  id=\"category\"\n                  v-model=\"category\"\n                  :disabled=\"true\"\n                >\n                  <option\n                    class=\"bg-gray-500\"\n                    value=\"FOLLOW_AND_RETWEET\"\n                    v-if=\"plan != 'FREE'\"\n                  >\n                    フォロー＆リツイート\n                  </option>\n                  <option\n                    class=\"bg-gray-500\"\n                    value=\"HASHTAG\"\n                    v-if=\"plan == 'SILVER' || plan == 'GOLD'\"\n                  >\n                    ハッシュタグキャンペーン\n                  </option>\n                  <option\n                    class=\"bg-gray-500\"\n                    value=\"INSTANT_WIN\"\n                    v-if=\"plan == 'GOLD'\"\n                  >\n                    インスタントウィン\n                  </option>\n                </select>\n              </div>\n            </div>\n          </div>\n          <div\n            class=\"flex flex-wrap items-center mb-4 border-gray-400 border-opacity-20\"\n            v-if=\"condition_flag.keyword\"\n          >\n            <div class=\"w-1/3 pl-18 text-left\">\n              <span class=\"text-sm font-medium text-gray-100\"\n                >キーワード\n                <i\n                  class=\"pi pi-question-circle mr-1\"\n                  v-tippy=\"{\n                    content:\n                      'ハッシュタグ必須。ハッシュタグは１つのみ登録してください。',\n                  }\"\n                ></i\n                >*\n              </span>\n            </div>\n            <div class=\"w-1/3 px-4 max-w-xl\">\n              <input\n                class=\"block py-4 px-3 w-full text-sm text-gray-50 placeholder-gray-300 font-medium outline-none bg-transparent border border-gray-400 hover:border-white focus:border-green-500 rounded-lg\"\n                type=\"text\"\n                v-model=\"keyword\"\n                placeholder=\"#xxxx記念\"\n              />\n            </div>\n            <div class=\"w-1/4 px-4 max-w-xl\">\n              <DoButton\n                :clickFunction=\"checkKeywordPromise\"\n                :values=\"{}\"\n                :disabled=\"!keyword || keyword_check\"\n                >キーワードチェック</DoButton\n              >\n            </div>\n          </div>\n          <div\n            class=\"flex flex-wrap items-center -mx-4 pb-8 mb-8 border-b border-gray-400 border-opacity-20\"\n            v-if=\"condition_flag.keyword\"\n          >\n            <div class=\"w-1/3 px-4 pb-4\">\n              <span class=\"text-sm font-medium text-gray-100\"></span>\n            </div>\n            <div class=\"w-2/3 px-4\">\n              <div\n                v-if=\"keyword_check_result\"\n                class=\"max-w-xl text-gray-100 text-left\"\n              >\n                {{ keyword_check_result }}\n              </div>\n            </div>\n          </div>\n          <div\n            class=\"flex flex-wrap items-center pb-8 mb-8 border-b border-gray-400 border-opacity-20\"\n            v-if=\"nouse_in_this_version\"\n          >\n            <div class=\"w-1/3 pl-18 text-left\">\n              <span class=\"text-sm font-medium text-gray-100\"\n                >キャンペーン概要</span\n              >\n            </div>\n            <div class=\"w-2/3 px-4 max-w-xl\">\n              <input\n                class=\"block py-4 px-3 w-full text-sm text-gray-50 placeholder-gray-300 font-medium outline-none bg-transparent border border-gray-400 hover:border-white focus:border-green-500 rounded-lg\"\n                id=\"abstract\"\n                type=\"text\"\n                v-model=\"abstract\"\n                placeholder=\"概要：xxxのサービス開始1周年を記念したキャンペーン。総額yyyyyドル分のzzzzをポイントの高い順にプレゼント\"\n              />\n            </div>\n          </div>\n          <div\n            class=\"flex flex-wrap items-center pb-8 mb-8 border-b border-gray-400 border-opacity-20\"\n            v-if=\"condition_flag.detail\"\n          >\n            <div class=\"w-1/3 pl-18 text-left\">\n              <span class=\"text-sm font-medium text-gray-100\"\n                >キャンペーン詳細</span\n              >\n            </div>\n            <div class=\"w-2/3 px-4 max-w-xl\">\n              <textarea\n                class=\"block py-4 px-3 w-full text-sm text-gray-50 placeholder-gray-300 font-medium outline-none bg-transparent border border-gray-400 hover:border-white focus:border-green-500 rounded-lg\"\n                rows=\"4\"\n                v-model=\"detail\"\n                placeholder=\"メモとしてご利用ください\"\n              />\n            </div>\n          </div>\n          <div\n            class=\"flex flex-wrap items-center pb-8 mb-8 border-b border-gray-400 border-opacity-20\"\n            v-if=\"condition_flag.start_time && condition_flag.end_time\"\n          >\n            <div class=\"w-1/3 pl-18 text-left\">\n              <span class=\"text-sm font-medium text-gray-100\"\n                >キャンペーン期間 *\n              </span>\n            </div>\n            <div class=\"w-full sm:w-2/3 px-4\">\n              <div class=\"max-w-xl flex\">\n                <div class=\"relative block px-3 w-full text-gray-100\">\n                  <Datepicker v-model=\"date\" range :min-date=\"min_date\" />\n                </div>\n              </div>\n            </div>\n          </div>\n          <div\n            class=\"flex flex-wrap items-center pb-8 mb-8 border-b border-gray-400 border-opacity-20\"\n            v-if=\"!condition_flag.start_time && condition_flag.end_time\"\n          >\n            <div class=\"w-1/3 pl-18 text-left\">\n              <span class=\"text-sm font-medium text-gray-100\">募集期限 * </span>\n            </div>\n            <div class=\"w-2/3 px-4 max-w-xl flex -mx-3\">\n              <div class=\"relative block px-3 w-full text-gray-100\">\n                <Datepicker v-model=\"date[1]\" :min-date=\"min_date\" />\n              </div>\n            </div>\n          </div>\n          <div\n            class=\"flex flex-wrap items-center pb-8 mb-8 border-b border-gray-400 border-opacity-20\"\n            v-if=\"condition_flag.amount\"\n          >\n            <div class=\"w-1/3 pl-18 text-left\">\n              <span class=\"text-sm font-medium text-gray-100\">当選人数 * </span>\n            </div>\n            <div class=\"w-1/3 px-4 max-w-xl\">\n              <input\n                class=\"block py-4 px-3 w-full text-sm text-gray-50 placeholder-gray-300 font-medium outline-none bg-transparent border border-gray-400 hover:border-white focus:border-green-500 rounded-lg\"\n                type=\"number\"\n                v-model=\"reword_amount\"\n                placeholder=\"10\"\n              />\n            </div>\n          </div>\n          <div\n            class=\"flex flex-wrap items-center pb-8 mb-8 border-b border-gray-400 border-opacity-20\"\n            v-if=\"condition_flag.estimated_participants_count\"\n          >\n            <div class=\"w-1/3 pl-18 text-left\">\n              <span class=\"text-sm font-medium text-gray-100\"\n                >想定参加人数\n                <i\n                  class=\"pi pi-question-circle mr-1\"\n                  v-tippy=\"{\n                    content: '当選確率を決定するために利用します',\n                  }\"\n                ></i\n                >*\n              </span>\n            </div>\n            <div class=\"w-1/3 px-4 max-w-xl\">\n              <input\n                class=\"block py-4 px-3 w-full text-sm text-gray-50 placeholder-gray-300 font-medium outline-none bg-transparent border border-gray-400 hover:border-white focus:border-green-500 rounded-lg\"\n                type=\"number\"\n                v-model=\"estimated_participants_count\"\n                placeholder=\"10000\"\n              />\n            </div>\n          </div>\n          <div\n            class=\"flex flex-wrap items-center pb-8 mb-8 border-b border-gray-400 border-opacity-20\"\n            v-if=\"condition_flag.distribution\"\n          >\n            <div class=\"w-1/3 pl-18 text-left\">\n              <span class=\"text-sm font-medium text-gray-100\"\n                >報酬の分配方法</span\n              >\n            </div>\n            <div class=\"w-2/3 px-4 max-w-xl\">\n              <div\n                class=\"relative block px-3 w-full text-sm font-medium border border-gray-400 hover:border-white focus-within:border-green-500 rounded-lg\"\n              >\n                <span\n                  class=\"absolute top-1/2 right-0 mr-5 transform -translate-y-1/2\"\n                >\n                  <i class=\"pi pi-chevron-down\"></i>\n                </span>\n                <select\n                  class=\"w-full py-4 text-gray-50 placeholder-gray-50 appearance-none bg-transparent outline-none\"\n                  id=\"distribution_type\"\n                  v-model=\"distribution_type\"\n                >\n                  <option class=\"bg-gray-500\" value=\"1\">\n                    獲得ポイントに基づくルールベースの分配\n                  </option>\n                  <option class=\"bg-gray-500\" value=\"2\">\n                    獲得ポイントに基づく抽選\n                  </option>\n                  <option class=\"bg-gray-500\" value=\"3\">\n                    その他（要望に合わせて対応いたします）\n                  </option>\n                </select>\n              </div>\n            </div>\n          </div>\n          <div\n            class=\"flex flex-wrap items-center mb-4 border-gray-400 border-opacity-20\"\n            v-if=\"condition_flag.twitter_account\"\n          >\n            <div class=\"w-1/3 pl-18 text-left\">\n              <span class=\"text-sm font-medium text-gray-100\"\n                >Twitterアカウント\n                <i\n                  class=\"pi pi-question-circle mr-1\"\n                  v-tippy=\"{\n                    content:\n                      'フォローを参加条件とする対象アカウントを入力してください',\n                  }\"\n                ></i\n                >*\n              </span>\n            </div>\n            <div class=\"w-1/3 px-4\">\n              <div class=\"max-w-xl\">\n                <input\n                  class=\"block py-4 px-3 w-full text-sm text-gray-50 placeholder-gray-300 font-medium outline-none bg-transparent border border-gray-400 hover:border-white focus:border-green-500 rounded-lg\"\n                  id=\"twitter_account\"\n                  type=\"text\"\n                  v-model=\"twitter_account\"\n                  placeholder=\"@username\"\n                />\n              </div>\n            </div>\n            <div class=\"w-1/4 px-4\">\n              <div class=\"max-w-xl\">\n                <DoButton\n                  :clickFunction=\"checkTwitterAccountPromise\"\n                  :values=\"{}\"\n                  :disabled=\"!twitter_account || twitter_account_check\"\n                  >アカウントチェック</DoButton\n                >\n              </div>\n            </div>\n          </div>\n          <div\n            class=\"flex flex-wrap items-center -mx-4 pb-8 mb-8 border-b border-gray-400 border-opacity-20\"\n            v-if=\"condition_flag.twitter_account\"\n          >\n            <div class=\"w-full sm:w-1/3 px-4 pb-4 sm:mb-0\">\n              <span class=\"text-sm font-medium text-gray-100\"></span>\n            </div>\n            <div class=\"w-full sm:w-2/3 px-4\">\n              <div\n                v-if=\"twitter_account_result\"\n                class=\"max-w-xl text-gray-100 text-left\"\n              >\n                {{ twitter_account_result }}\n              </div>\n            </div>\n          </div>\n          <div\n            class=\"flex flex-wrap items-center mb-4 border-gray-400 border-opacity-20\"\n            v-if=\"condition_flag.twitter_url\"\n          >\n            <div class=\"w-1/3 pl-18 text-left\">\n              <span class=\"text-sm font-medium text-gray-100\"\n                >Tweet URL\n                <i\n                  class=\"pi pi-question-circle mr-1\"\n                  v-tippy=\"{\n                    content:\n                      'リツイートを参加条件とする対象ツイートを入力してください',\n                  }\"\n                ></i>\n              </span>\n            </div>\n            <div class=\"w-full sm:w-1/3 px-4\">\n              <div class=\"max-w-xl\">\n                <input\n                  class=\"block py-4 px-3 w-full text-sm text-gray-50 placeholder-gray-300 font-medium outline-none bg-transparent border border-gray-400 hover:border-white focus:border-green-500 rounded-lg\"\n                  id=\"tweet_url\"\n                  type=\"text\"\n                  v-model=\"tweet_url\"\n                  placeholder=\"https://\"\n                />\n              </div>\n            </div>\n            <div class=\"w-1/4 px-4\">\n              <div class=\"max-w-xl\">\n                <DoButton\n                  :clickFunction=\"checkTweetPromise\"\n                  :values=\"{}\"\n                  :disabled=\"!tweet_url || tweet_url_check\"\n                  >ツイートチェック</DoButton\n                >\n              </div>\n            </div>\n          </div>\n          <div\n            class=\"flex flex-wrap items-center -mx-4 pb-8 mb-8 border-b border-gray-400 border-opacity-20\"\n            v-if=\"condition_flag.twitter_url\"\n          >\n            <div class=\"w-full sm:w-1/3 px-4 pb-4 sm:mb-0\">\n              <span class=\"text-sm font-medium text-gray-100\"></span>\n            </div>\n            <div class=\"w-full sm:w-2/3 px-4\">\n              <div\n                v-if=\"tweet_url_result\"\n                class=\"max-w-xl text-gray-100 text-left\"\n              >\n                {{ tweet_url_result }}\n              </div>\n            </div>\n          </div>\n          <div v-if=\"category == 'HASHTAG'\">\n            <DoButton\n              :clickFunction=\"patchCampaignPromise\"\n              :values=\"{}\"\n              :disabled=\"!filled\"\n              >変更</DoButton\n            >\n          </div>\n          <div v-if=\"category == 'FOLLOW_AND_RETWEET'\">\n            <DoButton\n              :clickFunction=\"patchCampaignPromise\"\n              :values=\"{}\"\n              :disabled=\"!follow_and_retweet_filled\"\n              >変更</DoButton\n            >\n          </div>\n          <div v-if=\"category == 'INSTANT_WIN'\">\n            <DoButton\n              :clickFunction=\"patchCampaignPromise\"\n              :values=\"{}\"\n              :disabled=\"!instant_win_filled\"\n              >変更</DoButton\n            >\n          </div>\n        </RightColumnOutline>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport SideVar from \"@/components/SideVar.vue\";\nimport Datepicker from \"@vuepic/vue-datepicker\";\nimport \"@vuepic/vue-datepicker/dist/main.css\";\nimport api from \"../api/api.js\";\nimport { ref } from \"vue\";\nimport { useRoute } from \"vue-router\";\nimport checks from \"../assets/mixins/Checks\";\n\nexport default {\n  name: \"Campaign_modify\",\n  mixins: [checks],\n  components: {\n    SideVar,\n    Datepicker,\n  },\n  setup() {\n    let date = ref();\n    return {\n      date,\n    };\n  },\n  data() {\n    return {\n      campaign_name: null,\n      category: null,\n      keyword: null,\n      abstract: null,\n      detail: null,\n      reword_amount: null,\n      reword_currency: null,\n      distribution_type: null,\n      today: new Date(),\n      start_date_db: new Date(),\n      nouse_in_this_version: false,\n\n      conditions_twitter_account: [],\n      conditions_tweet: [],\n\n      estimated_participants_count: null,\n    };\n  },\n  mounted() {\n    const route = useRoute();\n    api\n      .getCampaign({ id: route.params.id })\n      .then((response) => {\n        this.campaign_name = response.data[0][\"campaign_name\"];\n        this.category = response.data[0][\"category\"];\n        this.keyword = response.data[0][\"keyword\"];\n        this.abstract = response.data[0][\"abstruct\"];\n        this.detail = response.data[0][\"detail\"];\n        this.reword_amount = response.data[0][\"amount\"];\n        this.reword_currency = response.data[0][\"currency_id\"];\n        this.distribution_type = response.data[0][\"distribution_type\"];\n        // JSTに変換\n        let start_date = new Date(response.data[0][\"start_time\"]);\n        start_date.setHours(start_date.getHours() + 9);\n        let end_date = new Date(response.data[0][\"end_time\"]);\n        end_date.setHours(end_date.getHours() + 9);\n        this.date = [start_date, end_date];\n        this.start_date_db = response.data[0][\"start_time\"];\n        if (this.category == \"HASHTAG\") {\n          this.keyword_check = true;\n        }\n        if (this.category == \"INSTANT_WIN\") {\n          api\n            .getInstantWin({ campaign_id: route.params.id })\n            .then((response) => {\n              console.log(response);\n              this.estimated_participants_count =\n                response.data[0].est_participant;\n            });\n        }\n      })\n      .catch((error) => {\n        this.$toast.show(\"キャンペーンの取得に失敗しました\", {\n          type: \"error\",\n          position: \"top-right\",\n          duration: 5000,\n        });\n        console.log(\"error: \", error);\n      });\n  },\n  computed: {\n    plan: function () {\n      return this.$store.getters[\"subscribePlan\"];\n    },\n    min_date() {\n      const default_min = new Date(\n        new Date().setHours(this.today.getHours() + 1)\n      );\n      if (default_min >= this.start_date_db) {\n        return this.start_date_db;\n      } else {\n        return default_min;\n      }\n    },\n    filled() {\n      return (\n        this.campaign_name &&\n        this.keyword_check &&\n        this.category &&\n        this.keyword\n      );\n    },\n    follow_and_retweet_filled() {\n      return (\n        this.campaign_name &&\n        this.category &&\n        this.reword_amount &&\n        this.date[1]\n        // conditionsの変更はmodifyからは行わない\n      );\n    },\n    instant_win_filled() {\n      return (\n        this.campaign_name &&\n        this.category &&\n        this.reword_amount &&\n        this.date[1] &&\n        // conditionsの変更はmodifyからは行わない\n        this.estimated_participants_count\n      );\n    },\n    condition_flag: function () {\n      let return_dict = {\n        keyword: false,\n        abstruct: false,\n        detail: false,\n        distribution_type: false,\n        amount: false,\n        currency_id: false,\n        start_time: false,\n        end_time: false,\n        twitter_account: false,\n        twitter_url: false,\n      };\n      if (this.category == null) {\n        return return_dict;\n      } else if (this.category == \"HASHTAG\") {\n        // init\n        return_dict = {\n          keyword: true,\n          abstruct: true,\n          detail: true,\n          distribution_type: false,\n          amount: false,\n          currency_id: false,\n          start_time: true,\n          end_time: true,\n          twitter_account: false,\n          twitter_url: false,\n        };\n        return return_dict;\n      } else if (this.category == \"FOLLOW_AND_RETWEET\") {\n        // init\n        return_dict = {\n          keyword: false,\n          abstruct: false,\n          detail: false,\n          distribution_type: false,\n          amount: true,\n          currency_id: false,\n          start_time: false,\n          end_time: true,\n          twitter_account: false,\n          twitter_url: false,\n        };\n        return return_dict;\n      } else if (this.category == \"INSTANT_WIN\") {\n        return_dict = {\n          keyword: false,\n          abstruct: false,\n          detail: false,\n          distribution_type: false,\n          amount: true,\n          estimated_participants_count: true,\n          currency_id: false,\n          start_time: true,\n          end_time: true,\n          twitter_account: false,\n          twitter_url: false,\n        };\n        return return_dict;\n      } else {\n        return return_dict;\n      }\n    },\n  },\n  watch: {\n    keyword(value) {\n      this.keyword_check = false;\n      this.keyword_check_result = \"\";\n      if (value.indexOf(\"#\")) {\n        this.keyword = \"#\" + value;\n      }\n    },\n    twitter_account(value) {\n      this.twitter_account_check = false;\n      this.twitter_account_result = \"\";\n      if (value.indexOf(\"@\")) {\n        this.twitter_account = \"@\" + value;\n      }\n    },\n    tweet_url() {\n      this.tweet_url_check = false;\n      this.tweet_url_result = \"\";\n    },\n  },\n  methods: {\n    patchCampaignPromise: function () {\n      return new Promise((resolve) => {\n        api\n          .updateCampaign({\n            id: this.$route.params.id,\n            keyword: this.keyword,\n            start_time: this.date[0],\n            end_time: this.date[1],\n            campaign_name: this.campaign_name,\n            distribution_type: this.distribution_type,\n            amount: this.reword_amount,\n            currency_id: this.reword_currency,\n            category: this.category,\n          })\n          .then(() => {\n            if (this.category == \"INSTANT_WIN\") {\n              api\n                .updateInstantWin({\n                  campaign_id: this.$route.params.id,\n                  total_win: this.reword_amount,\n                  est_participant: this.estimated_participants_count,\n                  remain_win: this.reword_amount,\n                  prob: this.reword_amount / this.estimated_participants_count,\n                })\n                .then(() => {\n                  this.$toast.show(\"キャンペーンの変更が完了しました\", {\n                    type: \"success\",\n                    position: \"top-right\",\n                    duration: 3000,\n                  });\n                  this.$router.replace(\"/campaigns\");\n                })\n                .catch((error) => {\n                  this.$toast.show(\"インスタントウィンの変更に失敗しました\", {\n                    type: \"error\",\n                    position: \"top-right\",\n                    duration: 5000,\n                  });\n                  console.log(\"error: \", error);\n                });\n            } else {\n              this.$toast.show(\"キャンペーンの変更が完了しました\", {\n                type: \"success\",\n                position: \"top-right\",\n                duration: 3000,\n              });\n              this.$router.replace(\"/campaigns\");\n            }\n            resolve(\"resolved\");\n          })\n          .catch((error) => {\n            this.$toast.show(\"キャンペーンの変更に失敗しました\", {\n              type: \"error\",\n              position: \"top-right\",\n              duration: 5000,\n            });\n            console.log(\"error: \", error);\n            resolve(\"rejected\");\n          });\n      });\n    },\n  },\n};\n</script>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}